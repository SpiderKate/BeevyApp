{% extends "base.html" %}

{% block title %}Create Art / Commission üêù{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/create_art.css">
{% endblock %}

{% block content %}

<h1 class="page-title">{{ t('art.create') }}</h1>

<form action="/create_art" method="POST" enctype="multipart/form-data" class="create-form">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <!-- Title -->
    <label class="form-label">{{ t('art.title') }}</label>
    <input type="text" name="title" required class="input">

    <!-- Description -->
    <label class="form-label">{{ t('art.description') }}</label>
    <textarea name="description" rows="4" class="input"></textarea>

    <!-- TAT -->
    <label class="form-label">Turnaround Time (days)</label>
    <input type="number" name="tat" min="1" required class="input">

    <!-- Price -->
    <label class="form-label">{{ t('art.price') }} (Beevy Points)</label>
    <input type="number" name="price" min="1" required class="input">

    <!-- Type -->
    <label class="form-label">{{ t('art.type') }}</label>
    <select name="type" class="input" required>
        <option id="option" value="art">{{ t('art.selling') }}</option>
        <option id="option" value="commission" selected>{{ t('art.commission') }}</option>
    </select>

<!--TODO: art/comms rozdeleni-->
<!--TODO: slots pouze v comms-->
<!--TODO: save metadata in the file directly-->
<div class="slots">
    <!-- Slots -->
    <label for="commission" class="form-label">{{ t('art.commission_slots') }} (optional)</label>
    <input for="commission" type="number" name="slots" min="1" class="input">
</div>

   <!-- Thumbnail -->
<label>{{ t('settings.thumbnail') }}</label>
    <div class="file-wrapper"> 
        <label for="Input" class="file-label"> {{ t('settings.choose_file') }} </label> <br>
        <span id="fileName" class="file-name"> {{ t('settings.no_file_selected') }} </span> 
        <input type="file" name="thumb" id="Input"> 
    </div>

<!-- Examples -->
<label>{{ t('settings.examples') }}</label>
    <div class="file-wrapper"> 
        <label for="Input" class="file-label"> {{ t('settings.choose_file') }} </label> <br>
        <span id="fileName" class="file-name"> {{ t('settings.no_file_selected') }} </span> 
        <input type="file" name="examples" id="Input"> 
    </div>


    <button type="submit" class="submit" id="submit">Create</button>

</form>

<script>
// Thumbnail preview (fixed to display at shop size)
const thumbPreview = document.getElementById("thumbPreview");
const Input = document.getElementById("Input");
Input.addEventListener('change', () => {
        fileName.textContent = Input.files[0]?.name || "{{ t('settings.no_file') }}";
    });


thumbInput.addEventListener("change", () => {
    if (thumbInput.files && thumbInput.files[0]) {
        thumbPreview.src = URL.createObjectURL(thumbInput.files[0]);
        thumbPreview.style.display = "block";
        thumbPreview.style.width = "150px";  // match shop thumbnail width
        thumbPreview.style.height = "auto";  // maintain aspect ratio
    }
});

// Example images preview
const examplesInput = document.querySelector("input[name='examples']");
const examplesPreview = document.getElementById("examplesPreview");

examplesInput.addEventListener("change", () => {
    examplesPreview.innerHTML = ""; // clear previous previews
    Array.from(examplesInput.files).forEach(file => {
        const img = document.createElement("img");
        img.src = URL.createObjectURL(file);
        img.style.maxWidth = "150px";
        img.style.margin = "5px";
        examplesPreview.appendChild(img);
    });
});
</script>


{% endblock %}
